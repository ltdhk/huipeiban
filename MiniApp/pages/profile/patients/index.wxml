<view class="patients-container">
  <!-- 加载状态 -->
  <view wx:if="{{loading}}" class="loading">
    <text>加载中...</text>
  </view>

  <!-- 就诊人列表 -->
  <view wx:else class="patients-list">
    <view wx:if="{{patients.length === 0}}" class="empty">
      <text class="empty-text">暂无就诊人信息</text>
      <text class="empty-hint">点击下方按钮添加就诊人</text>
    </view>

    <view wx:else>
      <view
        wx:for="{{patients}}"
        wx:key="id"
        class="patient-card"
      >
        <view class="card-header">
          <view class="patient-name">
            <text class="name">{{item.name}}</text>
            <text wx:if="{{item.is_default}}" class="default-badge">默认</text>
          </view>
          <view class="card-actions">
            <text
              class="action-btn edit"
              data-id="{{item.id}}"
              bindtap="editPatient"
            >编辑</text>
            <text
              class="action-btn delete"
              data-id="{{item.id}}"
              data-name="{{item.name}}"
              bindtap="deletePatient"
            >删除</text>
          </view>
        </view>

        <view class="card-content">
          <view class="info-row">
            <text class="label">性别:</text>
            <text class="value">{{item.gender === 'male' ? '男' : item.gender === 'female' ? '女' : '未知'}}</text>
          </view>
          <view class="info-row" wx:if="{{item.phone}}">
            <text class="label">电话:</text>
            <text class="value">{{item.phone}}</text>
          </view>
          <view class="info-row" wx:if="{{item.relationship}}">
            <text class="label">关系:</text>
            <text class="value">{{item.relationship}}</text>
          </view>
          <view class="info-row" wx:if="{{item.birth_date}}">
            <text class="label">出生日期:</text>
            <text class="value">{{item.birth_date}}</text>
          </view>
        </view>

        <view class="card-footer" wx:if="{{!item.is_default}}">
          <button
            class="set-default-btn"
            data-id="{{item.id}}"
            bindtap="setDefault"
          >设为默认</button>
        </view>
      </view>
    </view>
  </view>

  <!-- 添加按钮 -->
  <view class="add-btn-wrapper">
    <button class="add-btn" bindtap="addPatient">
      + 添加就诊人
    </button>
  </view>
</view>
